//
//  HistoryTestCase.m
//  Tests
//
//  Created by Jordan Zucker on 5/18/16.
//  Copyright Â© 2016 Jordan Zucker. All rights reserved.
//

#import <PubNubTesting/PubNubTesting.h>

@interface HistoryTestCase : PNTClientTestCase

@end

@implementation HistoryTestCase

- (BOOL)isRecording {
    return NO;
}

- (NSString *)historyChannel {
    return @"a";
}

- (void)testGetHistoryForChannelWithExactlyOneHundredMessages {
    NSArray *messages = @[
                          @123,
                          @"********....... 8263 - 2016-06-08 12:31:41",
                          @123,
                          @123,
                          @"*********...... 8264 - 2016-06-08 12:32:45",
                          @123,
                          @"**********..... 8265 - 2016-06-08 12:33:50",
                          @123,
                          @"***********.... 8266 - 2016-06-08 12:34:54",
                          @123,
                          @"************... 8267 - 2016-06-08 12:35:58",
                          @123,
                          @"*************.. 8268 - 2016-06-08 12:37:03",
                          @123,
                          @"**************. 8269 - 2016-06-08 12:38:07",
                          @123,
                          @"*************** 8270 - 2016-06-08 12:39:11",
                          @123,
                          @"*.............. 8271 - 2016-06-08 12:40:16",
                          @123,
                          @"**............. 8272 - 2016-06-08 12:41:20",
                          @123,
                          @"***............ 8273 - 2016-06-08 12:42:24",
                          @123,
                          @"****........... 8274 - 2016-06-08 12:43:28",
                          @123,
                          @"*****.......... 8275 - 2016-06-08 12:44:33",
                          @123,
                          @"******......... 8276 - 2016-06-08 12:45:37",
                          @123,
                          @"*******........ 8277 - 2016-06-08 12:46:41",
                          @123,
                          @123,
                          @"********....... 8278 - 2016-06-08 12:47:46",
                          @123,
                          @"*********...... 8279 - 2016-06-08 12:48:50",
                          @123,
                          @"**********..... 8280 - 2016-06-08 12:49:54",
                          @123,
                          @"***********.... 8281 - 2016-06-08 12:50:59",
                          @123,
                          @"************... 8282 - 2016-06-08 12:52:03",
                          @123,
                          @"*************.. 8283 - 2016-06-08 12:53:07",
                          @123,
                          @"**************. 8284 - 2016-06-08 12:54:11",
                          @123,
                          @"*************** 8285 - 2016-06-08 12:55:16",
                          @123,
                          @"*.............. 8286 - 2016-06-08 12:56:20",
                          @123,
                          @"**............. 8287 - 2016-06-08 12:57:24",
                          @123,
                          @"***............ 8288 - 2016-06-08 12:58:29",
                          @123,
                          @"****........... 8289 - 2016-06-08 12:59:33",
                          @123,
                          @"*****.......... 8290 - 2016-06-08 13:00:37",
                          @123,
                          @"******......... 8291 - 2016-06-08 13:01:42",
                          @123,
                          @123,
                          @"*******........ 8292 - 2016-06-08 13:02:46",
                          @123,
                          @"********....... 8293 - 2016-06-08 13:03:50",
                          @123,
                          @"*********...... 8294 - 2016-06-08 13:04:54",
                          @123,
                          @"**********..... 8295 - 2016-06-08 13:05:59",
                          @123,
                          @"***********.... 8296 - 2016-06-08 13:07:03",
                          @123,
                          @"************... 8297 - 2016-06-08 13:08:07",
                          @123,
                          @"*************.. 8298 - 2016-06-08 13:09:12",
                          @123,
                          @"**************. 8299 - 2016-06-08 13:10:16",
                          @123,
                          @"*************** 8300 - 2016-06-08 13:11:20",
                          @123,
                          @"*.............. 8301 - 2016-06-08 13:12:25",
                          @123,
                          @"**............. 8302 - 2016-06-08 13:13:29",
                          @123,
                          @"***............ 8303 - 2016-06-08 13:14:33",
                          @123,
                          @"****........... 8304 - 2016-06-08 13:15:38",
                          @123,
                          @"*****.......... 8305 - 2016-06-08 13:16:42",
                          @123,
                          @123,
                          @"******......... 8306 - 2016-06-08 13:17:46",
                          @123,
                          @"*******........ 8307 - 2016-06-08 13:18:51",
                          @123,
                          @"********....... 8308 - 2016-06-08 13:19:55",
                          @123,
                          @"*********...... 8309 - 2016-06-08 13:20:59",
                          @123,
                          @"**********..... 8310 - 2016-06-08 13:22:03",
                          ];
    PNTTestHistoryResult *expectedResult = [PNTTestHistoryResult successfulResultWithClient:self.client start:@14654142431936747 end:@14654173241405040 messages:messages];
    [self.client historyForChannel:self.historyChannel withCompletion:[self PNT_historyCompletionBlockWithExpectedHistoryResult:expectedResult andExpectedError:nil]];
    [self PNT_waitFor:kPNTHistoryTimeout];
}

- (void)testGetHistoryForChannelWithNoMessages {
    NSArray *messages = @[
                          ];
    NSString *emptyChannel = @"please-dont-use-this-channel";
    PNTTestHistoryResult *expectedResult = [PNTTestHistoryResult successfulResultWithClient:self.client start:@0 end:@0 messages:messages];
    [self.client historyForChannel:emptyChannel withCompletion:[self PNT_historyCompletionBlockWithExpectedHistoryResult:expectedResult andExpectedError:nil]];
    [self PNT_waitFor:kPNTHistoryTimeout];
}

@end
